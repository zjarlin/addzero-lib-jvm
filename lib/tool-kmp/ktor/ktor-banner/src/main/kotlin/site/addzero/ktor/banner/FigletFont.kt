package site.addzero.ktor.banner

/**
 * 纯 Kotlin FIGlet 风格 ASCII Art 生成器
 *
 * 内置 "block" 字体（6行高），支持 A-Z 0-9 及常用符号。
 * 用法: FigletFont.render("HELLO")
 */
object FigletFont {

    const val HEIGHT = 6

    fun render(text: String): List<String> {
        val upper = text.uppercase()
        val result = Array(HEIGHT) { StringBuilder() }
        for (ch in upper) {
            val glyph = GLYPHS[ch] ?: GLYPHS[' ']!!
            for (row in 0 until HEIGHT) {
                result[row].append(glyph[row])
            }
        }
        return result.map { it.toString() }
    }

    private val GLYPHS: Map<Char, List<String>> = buildMap {
        put(' ', listOf("    ", "    ", "    ", "    ", "    ", "    "))
        put('A', listOf(
            " █████╗ ", "██╔══██╗", "███████║", "██╔══██║", "██║  ██║", "╚═╝  ╚═╝"))
        put('B', listOf(
            "██████╗ ", "██╔══██╗", "██████╔╝", "██╔══██╗", "██████╔╝", "╚═════╝ "))
        put('C', listOf(
            " ██████╗", "██╔════╝", "██║     ", "██║     ", "╚██████╗", " ╚═════╝"))
        put('D', listOf(
            "██████╗ ", "██╔══██╗", "██║  ██║", "██║  ██║", "██████╔╝", "╚═════╝ "))
        put('E', listOf(
            "███████╗", "██╔════╝", "█████╗  ", "██╔══╝  ", "███████╗", "╚══════╝"))
        put('F', listOf(
            "███████╗", "██╔════╝", "█████╗  ", "██╔══╝  ", "██║     ", "╚═╝     "))
        put('G', listOf(
            " ██████╗ ", "██╔════╝ ", "██║  ███╗", "██║   ██║", "╚██████╔╝", " ╚═════╝ "))
        put('H', listOf(
            "██╗  ██╗", "██║  ██║", "███████║", "██╔══██║", "██║  ██║", "╚═╝  ╚═╝"))
        put('I', listOf(
            "██╗", "██║", "██║", "██║", "██║", "╚═╝"))
        put('J', listOf(
            "     ██╗", "     ██║", "     ██║", "██   ██║", "╚█████╔╝", " ╚════╝ "))
        put('K', listOf(
            "██╗  ██╗", "██║ ██╔╝", "█████╔╝ ", "██╔═██╗ ", "██║  ██╗", "╚═╝  ╚═╝"))
        put('L', listOf(
            "██╗     ", "██║     ", "██║     ", "██║     ", "███████╗", "╚══════╝"))
        put('M', listOf(
            "███╗   ███╗", "████╗ ████║", "██╔████╔██║", "██║╚██╔╝██║", "██║ ╚═╝ ██║", "╚═╝     ╚═╝"))
        put('N', listOf(
            "███╗   ██╗", "████╗  ██║", "██╔██╗ ██║", "██║╚██╗██║", "██║ ╚████║", "╚═╝  ╚═══╝"))
        put('O', listOf(
            " ██████╗ ", "██╔═══██╗", "██║   ██║", "██║   ██║", "╚██████╔╝", " ╚═════╝ "))
        put('P', listOf(
            "██████╗ ", "██╔══██╗", "██████╔╝", "██╔═══╝ ", "██║     ", "╚═╝     "))
        put('Q', listOf(
            " ██████╗ ", "██╔═══██╗", "██║   ██║", "██║▄▄ ██║", "╚██████╔╝", " ╚══▀▀═╝ "))
        put('R', listOf(
            "██████╗ ", "██╔══██╗", "██████╔╝", "██╔══██╗", "██║  ██║", "╚═╝  ╚═╝"))
        put('S', listOf(
            "███████╗", "██╔════╝", "███████╗", "╚════██║", "███████║", "╚══════╝"))
        put('T', listOf(
            "████████╗", "╚══██╔══╝", "   ██║   ", "   ██║   ", "   ██║   ", "   ╚═╝   "))
        put('U', listOf(
            "██╗   ██╗", "██║   ██║", "██║   ██║", "██║   ██║", "╚██████╔╝", " ╚═════╝ "))
        put('V', listOf(
            "██╗   ██╗", "██║   ██║", "██║   ██║", "╚██╗ ██╔╝", " ╚████╔╝ ", "  ╚═══╝  "))
        put('W', listOf(
            "██╗    ██╗", "██║    ██║", "██║ █╗ ██║", "██║███╗██║", "╚███╔███╔╝", " ╚══╝╚══╝ "))
        put('X', listOf(
            "██╗  ██╗", "╚██╗██╔╝", " ╚███╔╝ ", " ██╔██╗ ", "██╔╝ ██╗", "╚═╝  ╚═╝"))
        put('Y', listOf(
            "██╗   ██╗", "╚██╗ ██╔╝", " ╚████╔╝ ", "  ╚██╔╝  ", "   ██║   ", "   ╚═╝   "))
        put('Z', listOf(
            "███████╗", "╚══███╔╝", "  ███╔╝ ", " ███╔╝  ", "███████╗", "╚══════╝"))
        // ── 数字 ──
        put('0', listOf(
            " ██████╗ ", "██╔═████╗", "██║██╔██║", "████╔╝██║", "╚██████╔╝", " ╚═════╝ "))
        put('1', listOf(
            " ██╗", "███║", "╚██║", " ██║", " ██║", " ╚═╝"))
        put('2', listOf(
            "██████╗ ", "╚════██╗", " █████╔╝", "██╔═══╝ ", "███████╗", "╚══════╝"))
        put('3', listOf(
            "██████╗ ", "╚════██╗", " █████╔╝", " ╚═══██╗", "██████╔╝", "╚═════╝ "))
        put('4', listOf(
            "██╗  ██╗", "██║  ██║", "███████║", "╚════██║", "     ██║", "     ╚═╝"))
        put('5', listOf(
            "███████╗", "██╔════╝", "███████╗", "╚════██║", "███████║", "╚══════╝"))
        put('6', listOf(
            " ██████╗ ", "██╔════╝ ", "██████╗  ", "██╔═══██╗", "╚██████╔╝", " ╚═════╝ "))
        put('7', listOf(
            "███████╗", "╚════██║", "    ██╔╝", "   ██╔╝ ", "   ██║  ", "   ╚═╝  "))
        put('8', listOf(
            " █████╗ ", "██╔══██╗", "╚█████╔╝", "██╔══██╗", "╚█████╔╝", " ╚════╝ "))
        put('9', listOf(
            " █████╗ ", "██╔══██╗", "╚██████║", " ╚═══██║", " █████╔╝", " ╚════╝ "))
        // ── 符号 ──
        put('-', listOf(
            "        ", "        ", "███████╗", "╚══════╝", "        ", "        "))
        put('.', listOf(
            "   ", "   ", "   ", "   ", "██╗", "╚═╝"))
        put('!', listOf(
            "██╗", "██║", "██║", "╚═╝", "██╗", "╚═╝"))
        put('_', listOf(
            "        ", "        ", "        ", "        ", "████████", "╚═══════╝"))
    }
}
